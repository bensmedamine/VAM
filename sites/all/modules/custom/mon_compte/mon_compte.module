<?php

/**
 * Implements hook_menu().
 */
function mon_compte_menu() {
  $items['inscription'] = array(
    'title' => 'Inscription',
    'page callback' => 'inscription',
    'access callback' => TRUE,
  );
  
  $items['annonces-manager'] = array(
    'title' => 'Annonces manager',
    'page callback' => 'annonces_manager',
    'access callback' => TRUE,
  );

  return $items;
}

/**
 * Implements hook_theme().
 */
function mon_compte_theme() {
  return array(
    'inscription' => array(
      'template' => 'themes/inscription'
    ),
  );
}

/**
 * Implements hook_form_alter().
 * @author BENSLIMANE Med Amine
 * @param array $form Form array
 * @param array $form_state Form values array
 * @param string $form_id Form ID
 */
function mon_compte_form_alter(&$form, &$form_state, $form_id) {
  global $user;
  switch ($form_id) {
    case 'user_login' :

      unset($form['name']['#description']);
      unset($form['pass']['#description']);
      $form['name']['#title'] = 'E-mail';
      $form['actions']['#suffix'] = '<p class="normal">' . l('&rarr; Créer un nouveau compte', 'inscription', array('html' => TRUE)) . '</p>';
      $form['actions']['#suffix'] .= '<p class="normal">' . l('&rarr; Vous avez oublié votre mot de passe ?', 'user/password', array('html' => TRUE)) . '</p>';

      break;
    case 'user_pass' :

      $form['name']['#title'] = 'E-mail';
      $form['name']['#description'] = 'Vous avez perdu votre mot de passe? Il vous suffit de saisir votre adresse e-mail d\'inscription. Vous recevrez un e-mail contenant un lien vous permettant de changer votre mot de passe.';

      break;
  }
}

function inscription() {

  $js = 'jQuery(function($){
            $("#edit-agence").hide();
            $(".form-item-type-annonceur input").click(function() {
              if($(this).val() == 1){
                $("#edit-agence").show();
              }else
                $("#edit-agence").hide();
            });
            
          });';

  drupal_add_js($js, 'inline');

  return theme('inscription', array('form' => drupal_get_form('inscription_form')));
}

function inscription_form() {
  $form = array();
  $form['informations_d_identification'] = array(
    '#markup' => '<h3>Informations d’identification</h3>',
  );
  $form['type_annonceur'] = array(
    '#type' => 'radios',
    '#title' => t('Vous êtes'),
    '#required' => TRUE,
    '#options' => array('Particulier', 'Prefessionnel'),
      //'#default_value' => ,
  );
  $form['email'] = array(
    '#type' => 'textfield',
    '#title' => ('E-mail'),
    '#size' => 60,
    '#maxlength' => 128,
    '#required' => TRUE,
      //'#default_value' => ,
  );
  $form['informations_contact'] = array(
    '#markup' => '<h3 class="top-20">Informations de contact</h3>',
  );
  $form['civilite'] = array(
    '#type' => 'radios',
    '#title' => t('Civilité'),
    '#required' => TRUE,
    '#options' => array('M.', 'Mme'),
      //'#default_value' => ,
  );
  $form['nom'] = array(
    '#type' => 'textfield',
    '#title' => t('Nom'),
    '#size' => 60,
    '#maxlength' => 128,
    '#required' => TRUE,
      //'#default_value' => ,
  );
  $form['prenom'] = array(
    '#type' => 'textfield',
    '#title' => t('Prénom'),
    '#size' => 60,
    '#maxlength' => 128,
    '#required' => TRUE,
      //'#default_value' => ,
  );
  $form['tel'] = array(
    '#type' => 'textfield',
    '#title' => t('Tél.'),
    '#size' => 20,
    '#maxlength' => 20,
    '#required' => TRUE,
      //'#default_value' => ,
  );

  $form['agence'] = array(
    '#type' => 'fieldset',
    '#collapsible' => FALSE,
    '#collapsed' => FALSE,
  );

  $form['agence']['informations_agence'] = array(
    '#markup' => '<h3 class="top-20">Informations agence</h3>',
  );
  $form['agence']['nom_agence'] = array(
    '#type' => 'textfield',
    '#title' => ('Nom de l\'agence <span title="Ce champ est obligatoire." class="form-required">*</span>'),
    '#size' => 60,
    '#maxlength' => 128,
      //'#default_value' => ,
  );
  $form['agence']['ville_agence'] = array(
    '#type' => 'select',
    '#title' => ('Ville <span title="Ce champ est obligatoire." class="form-required">*</span>'),
    '#options' => array(
      0 => t('No'),
      1 => t('Yes'),
    ),
      //'#default_value' => ,
  );
  $form['agence']['adresse_agence'] = array(
    '#type' => 'textfield',
    '#title' => t('Adresse'),
    '#size' => 60,
    '#maxlength' => 128,
      //'#default_value' => ,
  );
  $form['agence']['cp_agence'] = array(
    '#type' => 'textfield',
    '#title' => t('Code postal'),
    '#size' => 20,
    '#maxlength' => 11,
      //'#default_value' => ,
  );
  $form['agence']['tel_agence'] = array(
    '#type' => 'textfield',
    '#title' => ('Téléphone <span title="Ce champ est obligatoire." class="form-required">*</span>'),
    '#size' => 20,
    '#maxlength' => 20,
      //'#default_value' => ,
  );
  $form['agence']['site_web_agence'] = array(
    '#type' => 'textfield',
    '#title' => t('Site web'),
    '#size' => 60,
    '#maxlength' => 128,
      //'#default_value' => ,
  );

  $form['agence']['logo_agence'] = array(
    '#type' => 'file',
    '#title' => t('Logo'),
    '#size' => 35,
    '#attributes' => array('class' => array('has-description')),
    '#description' => 'Formats autorisés : JPG, JPEG, PNG ou GIF',
  );
  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Envoyé'),
    '#attributes' => array('class' => array('custom-submitt-button top-20')),
  );
  return $form;
}

function inscription_form_validate($form, &$form_state) {
  
}

function inscription_form_submit($form, &$form_state) {

  echo '<pre>';
  print_r($_FILES);
  echo '</pre>';
  die('DEBUG MODE');
}

?>
